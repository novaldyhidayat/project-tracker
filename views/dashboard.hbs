{{!< layouts/main}}

<div class="animate-fade-in">
  <div class="mb-8">
    <div class="flex items-center justify-between">
      <div>
        <h2 class="text-2xl font-bold text-gray-800 mb-2">Welcome back, {{user.name}}!</h2>
        <p class="text-gray-600">Here's what's happening with your projects today.</p>
      </div>
      <div class="flex gap-3">
        <button class="btn btn-secondary" onclick="refreshDashboard()">
          <i class="fas fa-sync-alt"></i>
          Refresh
        </button>
        <button class="btn btn-primary" onclick="createNewTask()">
          <i class="fas fa-plus"></i>
          New Task
        </button>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <div class="card stat-card">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm font-medium text-gray-600 mb-1">Total Tasks</p>
          <p class="text-3xl font-bold text-gray-800" id="totalTasks">0</p>
        </div>
        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-tasks text-blue-600 text-xl"></i>
        </div>
      </div>
      <div class="mt-4 flex items-center">
        <span class="text-sm text-green-600 font-medium">+12%</span>
        <span class="text-sm text-gray-500 ml-2">from last week</span>
      </div>
    </div>

    <div class="card stat-card">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm font-medium text-gray-600 mb-1">In Progress</p>
          <p class="text-3xl font-bold text-gray-800" id="inProgressTasks">0</p>
        </div>
        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-clock text-yellow-600 text-xl"></i>
        </div>
      </div>
      <div class="mt-4 flex items-center">
        <span class="text-sm text-yellow-600 font-medium">+5%</span>
        <span class="text-sm text-gray-500 ml-2">from yesterday</span>
      </div>
    </div>

    <div class="card stat-card">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm font-medium text-gray-600 mb-1">Completed</p>
          <p class="text-3xl font-bold text-gray-800" id="completedTasks">0</p>
        </div>
        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-check-circle text-green-600 text-xl"></i>
        </div>
      </div>
      <div class="mt-4 flex items-center">
        <span class="text-sm text-green-600 font-medium">+8%</span>
        <span class="text-sm text-gray-500 ml-2">this week</span>
      </div>
    </div>

    <div class="card stat-card">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm font-medium text-gray-600 mb-1">Team Members</p>
          <p class="text-3xl font-bold text-gray-800" id="teamMembers">0</p>
        </div>
        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
          <i class="fas fa-users text-purple-600 text-xl"></i>
        </div>
      </div>
      <div class="mt-4 flex items-center">
        <span class="text-sm text-blue-600 font-medium">+2</span>
        <span class="text-sm text-gray-500 ml-2">new this month</span>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <div class="lg:col-span-2">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Recent Activity</h3>
        </div>
        <div class="card-content">
          <div class="space-y-4" id="recentActivity">
            <div class="flex items-start gap-3 p-3 rounded-lg hover:bg-gray-50 transition-colors">
              <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
                <i class="fas fa-plus text-blue-600 text-xs"></i>
              </div>
              <div class="flex-1">
                <p class="text-sm font-medium text-gray-800">New task created</p>
                <p class="text-xs text-gray-500">2 hours ago</p>
              </div>
            </div>

            <div class="flex items-start gap-3 p-3 rounded-lg hover:bg-gray-50 transition-colors">
              <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0">
                <i class="fas fa-check text-green-600 text-xs"></i>
              </div>
              <div class="flex-1">
                <p class="text-sm font-medium text-gray-800">Task "Update user interface" completed</p>
                <p class="text-xs text-gray-500">4 hours ago</p>
              </div>
            </div>

            <div class="flex items-start gap-3 p-3 rounded-lg hover:bg-gray-50 transition-colors">
              <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0">
                <i class="fas fa-clock text-yellow-600 text-xs"></i>
              </div>
              <div class="flex-1">
                <p class="text-sm font-medium text-gray-800">Task "Review code changes" in progress</p>
                <p class="text-xs text-gray-500">6 hours ago</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="space-y-6">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Quick Actions</h3>
        </div>
        <div class="card-content">
          <div class="space-y-3">
            <button class="w-full btn btn-secondary justify-start" onclick="createNewTask()">
              <i class="fas fa-plus"></i>
              Create New Task
            </button>
            <button class="w-full btn btn-ghost justify-start" onclick="viewAllTasks()">
              <i class="fas fa-list"></i>
              View All Tasks
            </button>
            <button class="w-full btn btn-ghost justify-start" onclick="manageTeam()">
              <i class="fas fa-users"></i>
              Manage Team
            </button>
            <button class="w-full btn btn-ghost justify-start" onclick="viewReports()">
              <i class="fas fa-chart-bar"></i>
              View Reports
            </button>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Upcoming Deadlines</h3>
        </div>
        <div class="card-content">
          <div class="space-y-3" id="upcomingDeadlines">
            <div class="flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-200">
              <div>
                <p class="text-sm font-medium text-gray-800">Design Review</p>
                <p class="text-xs text-red-600">Due today</p>
              </div>
              <i class="fas fa-exclamation-triangle text-red-500"></i>
            </div>

            <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg border border-yellow-200">
              <div>
                <p class="text-sm font-medium text-gray-800">API Integration</p>
                <p class="text-xs text-yellow-600">Due in 2 days</p>
              </div>
              <i class="fas fa-clock text-yellow-500"></i>
            </div>

            <div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200">
              <div>
                <p class="text-sm font-medium text-gray-800">Testing Phase</p>
                <p class="text-xs text-blue-600">Due in 1 week</p>
              </div>
              <i class="fas fa-calendar text-blue-500"></i>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Team Performance</h3>
        </div>
        <div class="card-content">
          <div class="space-y-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                  <span class="text-xs font-medium text-blue-600">JD</span>
                </div>
                <div>
                  <p class="text-sm font-medium">John Doe</p>
                  <p class="text-xs text-gray-500">5 tasks completed</p>
                </div>
              </div>
              <div class="w-16 bg-gray-200 rounded-full h-2">
                <div class="bg-blue-500 h-2 rounded-full" style="width: 80%"></div>
              </div>
            </div>

            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                  <span class="text-xs font-medium text-green-600">JS</span>
                </div>
                <div>
                  <p class="text-sm font-medium">Jane Smith</p>
                  <p class="text-xs text-gray-500">3 tasks completed</p>
                </div>
              </div>
              <div class="w-16 bg-gray-200 rounded-full h-2">
                <div class="bg-green-500 h-2 rounded-full" style="width: 60%"></div>
              </div>
            </div>

            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                  <span class="text-xs font-medium text-purple-600">MB</span>
                </div>
                <div>
                  <p class="text-sm font-medium">Mike Brown</p>
                  <p class="text-xs text-gray-500">7 tasks completed</p>
                </div>
              </div>
              <div class="w-16 bg-gray-200 rounded-full h-2">
                <div class="bg-purple-500 h-2 rounded-full" style="width: 90%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .stat-card {
    background: linear-gradient(135deg, var(--surface) 0%, var(--surface-elevated) 100%);
  }

  .stat-card:hover {
    transform: translateY(-4px);
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  gsap.from('.stat-card', {
    y: 30,
    opacity: 0,
    duration: 0.6,
    stagger: 0.1,
    ease: 'power2.out'
  });

  gsap.from('.card', {
    y: 20,
    opacity: 0,
    duration: 0.5,
    delay: 0.3,
    stagger: 0.1,
    ease: 'power2.out'
  });

  loadDashboardData();
});

function loadDashboardData() {
  animateNumber('totalTasks', 0, 24, 1000);
  animateNumber('inProgressTasks', 0, 8, 1000);
  animateNumber('completedTasks', 0, 16, 1000);
  animateNumber('teamMembers', 0, 12, 1000);
}

function animateNumber(elementId, start, end, duration) {
  const element = document.getElementById(elementId);
  const startTime = Date.now();

  function update() {
    const elapsed = Date.now() - startTime;
    const progress = Math.min(elapsed / duration, 1);
    const current = Math.floor(start + (end - start) * progress);

    element.textContent = current;

    if (progress < 1) {
      requestAnimationFrame(update);
    }
  }

  update();
}

function refreshDashboard() {
  const button = event.target.closest('button');
  const icon = button.querySelector('i');
  icon.classList.add('fa-spin');
  setTimeout(() => {
    icon.classList.remove('fa-spin');
    loadDashboardData();
  }, 1000);
}

function createNewTask() {
  window.location.href = '/board';
}

function viewAllTasks() {
  window.location.href = '/board';
}

function manageTeam() {
  window.location.href = '/users';
}

function viewReports() {
  alert('Reports feature coming soon!');
}

document.querySelectorAll('.card').forEach(card => {
  card.addEventListener('mouseenter', function() {
    gsap.to(this, {
      y: -2,
      duration: 0.2,
      ease: 'power2.out'
    });
  });

  card.addEventListener('mouseleave', function() {
    gsap.to(this, {
      y: 0,
      duration: 0.2,
      ease: 'power2.out'
    });
  });
});
</script>
